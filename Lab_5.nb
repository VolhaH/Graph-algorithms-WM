(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     53415,       1195]
NotebookOptionsPosition[     51694,       1159]
NotebookOutlinePosition[     52036,       1174]
CellTagsIndexPosition[     51993,       1171]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "2.", " ", "\:0421\:0447\:0438\:0442\:0430\:0442\:044c", " ", 
   "\:0434\:0430\:043d\:043d\:044b\:0435", " ", "\:0438\:0437", " ", 
   "\:043f\:043e\:043b\:0443\:0447\:0435\:043d\:043d\:043e\:0433\:043e", " ", 
   "\:0432\:0445\:043e\:0434\:043d\:043e\:0433\:043e", " ", 
   "\:0444\:0430\:0439\:043b\:0430", " ", "\:0432", " ", 
   "\:0441\:0438\:0441\:0442\:0435\:043c\:0435", " ", "Wolfram", " ", 
   "Mathematica", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\:0443\:0447\:0435\:0441\:0442\:044c", ",", " ", 
      RowBox[{
      "\:0447\:0442\:043e", " ", 
       "\:0440\:0430\:0437\:043c\:0435\:0440\:043d\:043e\:0441\:0442\:044c", 
       " ", "\:0433\:0440\:0430\:0444\:0430", " ", 
       "\:043c\:043e\:0436\:0435\:0442", " ", "\:0431\:044b\:0442\:044c", " ",
        "\:043b\:044e\:0431\:043e\:0439", " ", "\:0438", " ", 
       "\:043f\:0430\:0440\:0430\:043c\:0435\:0442\:0440\:044b", " ", "bi", 
       " ", "\:043c\:043e\:0433\:0443\:0442", " ", "\:0438\:0434\:0442\:0438",
        " ", "\:0432", " ", 
       "\:043f\:0440\:043e\:0438\:0437\:0432\:043e\:043b\:044c\:043d\:043e\
\:043c", " ", "\:043f\:043e\:0440\:044f\:0434\:043a\:0435"}]}], ")"}], 
    "."}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7784288808992076`*^9, 3.778428881275201*^9}, {
  3.778428921292515*^9, 
  3.7784289479125104`*^9}},ExpressionUUID->"1b7ce8ea-dbff-4939-9217-\
7bcd9cdeb321"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"inFileName", "=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<input.txt\>\""}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"fileStream", "=", 
   RowBox[{"OpenRead", "[", "inFileName", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Is", "=", 
   RowBox[{
    RowBox[{"Read", "[", 
     RowBox[{"fileStream", ",", 
      RowBox[{"{", 
       RowBox[{"Word", ",", "Number"}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Us", "=", 
   RowBox[{
    RowBox[{"Read", "[", 
     RowBox[{"fileStream", ",", 
      RowBox[{"{", 
       RowBox[{"Word", ",", "Number"}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"ReadList", "[", 
    RowBox[{"fileStream", ",", "Expression", ",", "Us"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"ReadList", "[", 
    RowBox[{"fileStream", ",", "String", ",", "Is"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"StringSplit", "[", 
       RowBox[{
        RowBox[{"b", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<b\>\"", ",", "\"\<_\>\"", ",", "\"\</*\>\"", ",", "\"\<*/ \>\"",
           ",", " ", "\"\< \>\""}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", "Is"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"UDirect", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"U", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[DirectedEdge]", 
     RowBox[{"U", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "Us"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "fileStream", "]"}], ";"}], "\n"}], "Input",
 CellChangeTimes->{{3.778429793810244*^9, 3.7784298212997503`*^9}, 
   3.7784300937669687`*^9, {3.7784302938500676`*^9, 3.778430296018265*^9}, 
   3.7784304261443853`*^9, {3.778437081690615*^9, 3.778437088378363*^9}, {
   3.778437573845547*^9, 3.778437593120984*^9}, {3.7784376404345274`*^9, 
   3.7784376854162755`*^9}, {3.7784377621002326`*^9, 3.778437784277978*^9}, {
   3.7784380533456144`*^9, 3.778438063006787*^9}, {3.778438123408311*^9, 
   3.778438161390765*^9}, {3.7784382283477607`*^9, 3.7784382296163692`*^9}, {
   3.778438436104374*^9, 3.778438467530362*^9}, {3.778438598548066*^9, 
   3.7784386100552993`*^9}, {3.7784386514356728`*^9, 
   3.7784386817885303`*^9}, {3.7784387186140776`*^9, 
   3.7784387463220053`*^9}, {3.7788392293000965`*^9, 3.778839276867894*^9}, {
   3.7788398703504453`*^9, 3.778839893504545*^9}, {3.7788399377410965`*^9, 
   3.7788399432972336`*^9}, {3.778839981729523*^9, 3.778840020217593*^9}, {
   3.7788400610983105`*^9, 3.7788401137006836`*^9}, {3.7788401593686275`*^9, 
   3.778840201190837*^9}, {3.7788402790770235`*^9, 3.778840304839156*^9}, {
   3.778840345893442*^9, 3.778840372314805*^9}, {3.7788404596288195`*^9, 
   3.778840641551264*^9}, {3.7788406798961315`*^9, 3.7788406883301277`*^9}, {
   3.7788407718930235`*^9, 3.7788407774082747`*^9}, {3.7788412431663094`*^9, 
   3.7788413683924246`*^9}, {3.7788414058452644`*^9, 3.778841419814953*^9}, {
   3.7788416070225058`*^9, 3.7788416076456347`*^9}, {3.7788416559731293`*^9, 
   3.778841721455076*^9}, {3.778841785030343*^9, 3.778841898063203*^9}, {
   3.778841990397901*^9, 3.77884199636449*^9}, {3.7788420660372133`*^9, 
   3.778842086130537*^9}, {3.7788421261964254`*^9, 3.7788421292682285`*^9}, {
   3.778842547396488*^9, 3.7788425595161376`*^9}, {3.7788427047119193`*^9, 
   3.7788427916634607`*^9}, {3.7788431105444794`*^9, 
   3.7788431322205324`*^9}, {3.7788432473384037`*^9, 3.778843304449789*^9}, {
   3.779098548678602*^9, 3.7790985508657513`*^9}, {3.7790986824220486`*^9, 
   3.779098714737692*^9}, {3.7790998986635284`*^9, 3.779099931684259*^9}, {
   3.7791031304006085`*^9, 3.77910313209031*^9}, {3.7791033515533886`*^9, 
   3.7791033524561872`*^9}, {3.7791163963417854`*^9, 3.779116398954356*^9}, {
   3.779117617373397*^9, 3.7791176382441854`*^9}, {3.7791176685080843`*^9, 
   3.7791178300884953`*^9}, {3.779117897528608*^9, 3.7791179134522495`*^9}, {
   3.7791191007519503`*^9, 3.779119138308735*^9}, {3.779119339561862*^9, 
   3.7791193663904657`*^9}, {3.779119480556128*^9, 3.779119584452592*^9}, {
   3.7791196204381437`*^9, 3.7791196600635376`*^9}, {3.7815352542328463`*^9, 
   3.781535270758613*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"e69d8df6-be5a-4f90-a502-029034a4cbd3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1", "\[DirectedEdge]", "2"}], ",", 
   RowBox[{"3", "\[DirectedEdge]", "1"}], ",", 
   RowBox[{"1", "\[DirectedEdge]", "4"}], ",", 
   RowBox[{"5", "\[DirectedEdge]", "2"}], ",", 
   RowBox[{"1", "\[DirectedEdge]", "6"}], ",", 
   RowBox[{"3", "\[DirectedEdge]", "6"}], ",", 
   RowBox[{"3", "\[DirectedEdge]", "7"}], ",", 
   RowBox[{"4", "\[DirectedEdge]", "3"}], ",", 
   RowBox[{"5", "\[DirectedEdge]", "3"}], ",", 
   RowBox[{"5", "\[DirectedEdge]", "6"}], ",", 
   RowBox[{"6", "\[DirectedEdge]", "2"}], ",", 
   RowBox[{"7", "\[DirectedEdge]", "1"}], ",", 
   RowBox[{"7", "\[DirectedEdge]", "4"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7784301988410606`*^9, 3.7784302970914*^9, 3.7784304267557507`*^9, 
   3.778437671218199*^9, {3.7784380549084387`*^9, 3.7784380640170884`*^9}, {
   3.7784381260871477`*^9, 3.7784381621068506`*^9}, 3.778438236360339*^9, {
   3.7784384546567755`*^9, 3.7784384696905556`*^9}, {3.7784386624572077`*^9, 
   3.7784386690824966`*^9}, 3.7784387483116837`*^9, 3.778839075623825*^9, {
   3.7788392435659246`*^9, 3.778839268312767*^9}, 3.778840202473349*^9, {
   3.7788404601294756`*^9, 3.7788404873925877`*^9}, 3.7788405492082872`*^9, {
   3.778840621193404*^9, 3.7788406421915455`*^9}, {3.778840681098873*^9, 
   3.7788406893296695`*^9}, 3.7788407725213385`*^9, 3.7788412594757123`*^9, 
   3.778841330232399*^9, 3.7788413698405085`*^9, 3.778841420310582*^9, 
   3.7788416089359093`*^9, 3.7788417912297688`*^9, 3.778841899452445*^9, 
   3.7788419969588985`*^9, 3.7788420394074106`*^9, {3.778842074661156*^9, 
   3.778842088948962*^9}, 3.778842130515836*^9, 3.7788425606350937`*^9, {
   3.7788427117331457`*^9, 3.778842741211341*^9}, 3.7788427925640516`*^9, 
   3.7788431333933525`*^9, 3.7788433120384426`*^9, 3.779093342439495*^9, 
   3.779098554672575*^9, {3.7790986920702543`*^9, 3.7790987118304267`*^9}, 
   3.779098986127083*^9, 3.779099830992445*^9, {3.779099904271536*^9, 
   3.7790999321879063`*^9}, {3.7791020069792747`*^9, 3.779102007075148*^9}, 
   3.779102933383176*^9, 3.7791029686640854`*^9, 3.7791031474258776`*^9, 
   3.779103353215168*^9, 3.779103414081933*^9, 3.779103464023304*^9, 
   3.779103676560698*^9, 3.7791163999769673`*^9, 3.7791176389791946`*^9, {
   3.779117672622551*^9, 3.77911769698043*^9}, {3.7791177301562243`*^9, 
   3.7791178315505238`*^9}, {3.7791179056149735`*^9, 3.779117914051483*^9}, {
   3.779119114305809*^9, 3.7791191388554163`*^9}, {3.779119340496559*^9, 
   3.7791193540149336`*^9}, {3.7791194892681293`*^9, 3.779119516018961*^9}, {
   3.779119566024793*^9, 3.779119586218239*^9}, 3.779119648463215*^9, 
   3.7791202892938995`*^9, 3.7791206134667006`*^9, 3.781438353817978*^9, 
   3.7815207399733367`*^9, 3.781533171296006*^9, {3.7815352576915607`*^9, 
   3.781535276029788*^9}},
 CellLabel->
  "Out[153]=",ExpressionUUID->"00cb8ff5-8dac-47a9-9b39-248f1589dec0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "3.", " ", "\:041f\:043e", " ", 
    "\:043f\:043e\:043b\:0443\:0447\:0435\:043d\:043d\:044b\:043c", " ", 
    "\:0434\:0430\:043d\:043d\:044b\:043c", " ", 
    "\:0441\:043e\:0437\:0434\:0430\:0442\:044c", " ", 
    "\:043e\:0440\:0438\:0435\:043d\:0442\:0438\:0440\:043e\:0432\:0430\:043d\
\:043d\:044b\:0439", " ", "\:0433\:0440\:0430\:0444", " ", "\:0441", " ", 
    "\:0437\:0430\:0434\:0430\:043d\:0438\:0435\:043c", " ", 
    RowBox[{"\:0441\:0442\:0438\:043b\:0435\:0439", "/"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"g", " ", "=", " ", 
   RowBox[{"Graph", "[", 
    RowBox[{"UDirect", ",", " ", 
     RowBox[{"GraphLayout", "\[Rule]", "\"\<CircularEmbedding\>\""}], ",", 
     " ", 
     RowBox[{"VertexLabels", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{"\"\<Name\>\"", ",", "Center"}], "]"}]}], ",", " ", 
     RowBox[{"VertexSize", "\[Rule]", "0.4"}], ",", " ", 
     RowBox[{"VertexLabelStyle", "\[Rule]", " ", 
      RowBox[{"Directive", "[", 
       RowBox[{"Italic", ",", " ", "28"}], "]"}]}], ",", " ", 
     RowBox[{"EdgeShapeFunction", "\[Rule]", 
      RowBox[{"GraphElementData", "[", 
       RowBox[{"\"\<FilledArrow\>\"", ",", 
        RowBox[{"\"\<ArrowSize\>\"", "\[Rule]", "0.05"}]}], "]"}]}], ",", " ", 
     RowBox[{"EdgeStyle", "\[Rule]", "Thick"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{3.778843349365654*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"f1742808-91c5-4adb-b771-865cc7d1513c"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 3, 4, 5, 6, 
      7}, {{{1, 2}, {3, 1}, {1, 4}, {5, 2}, {1, 6}, {3, 6}, {3, 7}, {4, 3}, {
       5, 3}, {5, 6}, {6, 2}, {7, 1}, {7, 4}}, Null}, {EdgeShapeFunction -> {
         GraphElementData["FilledArrow", "ArrowSize" -> 0.05]}, EdgeStyle -> {
         Thickness[Large]}, GraphLayout -> "CircularEmbedding", VertexLabels -> {
         Placed["Name", Center]}, VertexLabelStyle -> {
         Directive[Italic, 28]}, VertexSize -> {0.4}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Thickness[Large], Opacity[0.7], 
        {Arrowheads[{{0.05, 0.8, {
             GraphicsBox[
              
              FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 
               0}}}, {{{-1., -0.31249915682968066`}, {-0.8749949409780775, \
-8.881784197001252*^-16}, {-1., 0.3124991568296789}, {
               0., -8.881784197001252*^-16}}}]], 0.8749949409780782}}}], 
         ArrowBox[{{-0.7818314824680302, 
          0.6234898018587343}, {-0.9749279121818235, \
-0.22252093395631342`}}]}, 
        {Arrowheads[{{0.05, 0.8, {
             GraphicsBox[
              
              FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 
               0}}}, {{{-1., -0.31249915682968066`}, {-0.8749949409780775, \
-8.881784197001252*^-16}, {-1., 0.3124991568296789}, {
               0., -8.881784197001252*^-16}}}]], 0.8749949409780782}}}], 
         ArrowBox[{{-0.7818314824680302, 0.6234898018587343}, {
          0.43388373911755884`, -0.9009688679024196}}]}, 
        {Arrowheads[{{0.05, 0.8, {
             GraphicsBox[
              
              FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 
               0}}}, {{{-1., -0.31249915682968066`}, {-0.8749949409780775, \
-8.881784197001252*^-16}, {-1., 0.3124991568296789}, {
               0., -8.881784197001252*^-16}}}]], 0.8749949409780782}}}], 
         ArrowBox[{{-0.7818314824680302, 0.6234898018587343}, {
          0.7818314824680294, 0.6234898018587326}}]}, 
        {Arrowheads[{{0.05, 0.8, {
             GraphicsBox[
              
              FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 
               0}}}, {{{-1., -0.31249915682968066`}, {-0.8749949409780775, \
-8.881784197001252*^-16}, {-1., 0.3124991568296789}, {
               0., -8.881784197001252*^-16}}}]], 0.8749949409780782}}}], 
         ArrowBox[{{-0.43388373911755757`, -0.9009688679024187}, \
{-0.7818314824680302, 0.6234898018587343}}]}, 
        {Arrowheads[{{0.05, 0.8, {
             GraphicsBox[
              
              FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 
               0}}}, {{{-1., -0.31249915682968066`}, {-0.8749949409780775, \
-8.881784197001252*^-16}, {-1., 0.3124991568296789}, {
               0., -8.881784197001252*^-16}}}]], 0.8749949409780782}}}], 
         ArrowBox[{{-0.43388373911755757`, -0.9009688679024187}, {
          0.7818314824680294, 0.6234898018587326}}]}, 
        {Arrowheads[{{0.05, 0.8, {
             GraphicsBox[
              
              FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 
               0}}}, {{{-1., -0.31249915682968066`}, {-0.8749949409780775, \
-8.881784197001252*^-16}, {-1., 0.3124991568296789}, {
               0., -8.881784197001252*^-16}}}]], 0.8749949409780782}}}], 
         ArrowBox[{{-0.43388373911755757`, -0.9009688679024187}, \
{-7.044813998280222*^-16, 1.}}]}, 
        {Arrowheads[{{0.05, 0.8, {
             GraphicsBox[
              
              FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 
               0}}}, {{{-1., -0.31249915682968066`}, {-0.8749949409780775, \
-8.881784197001252*^-16}, {-1., 0.3124991568296789}, {
               0., -8.881784197001252*^-16}}}]], 0.8749949409780782}}}], 
         ArrowBox[{{
          0.43388373911755884`, -0.9009688679024196}, {-0.43388373911755757`, \
-0.9009688679024187}}]}, 
        {Arrowheads[{{0.05, 0.8, {
             GraphicsBox[
              
              FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 
               0}}}, {{{-1., -0.31249915682968066`}, {-0.8749949409780775, \
-8.881784197001252*^-16}, {-1., 0.3124991568296789}, {
               0., -8.881784197001252*^-16}}}]], 0.8749949409780782}}}], 
         ArrowBox[{{
          0.9749279121818237, -0.2225209339563155}, {-0.9749279121818235, \
-0.22252093395631342`}}]}, 
        {Arrowheads[{{0.05, 0.8, {
             GraphicsBox[
              
              FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 
               0}}}, {{{-1., -0.31249915682968066`}, {-0.8749949409780775, \
-8.881784197001252*^-16}, {-1., 0.3124991568296789}, {
               0., -8.881784197001252*^-16}}}]], 0.8749949409780782}}}], 
         ArrowBox[{{
          0.9749279121818237, -0.2225209339563155}, {-0.43388373911755757`, \
-0.9009688679024187}}]}, 
        {Arrowheads[{{0.05, 0.8, {
             GraphicsBox[
              
              FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 
               0}}}, {{{-1., -0.31249915682968066`}, {-0.8749949409780775, \
-8.881784197001252*^-16}, {-1., 0.3124991568296789}, {
               0., -8.881784197001252*^-16}}}]], 0.8749949409780782}}}], 
         ArrowBox[{{0.9749279121818237, -0.2225209339563155}, {
          0.7818314824680294, 0.6234898018587326}}]}, 
        {Arrowheads[{{0.05, 0.8, {
             GraphicsBox[
              
              FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 
               0}}}, {{{-1., -0.31249915682968066`}, {-0.8749949409780775, \
-8.881784197001252*^-16}, {-1., 0.3124991568296789}, {
               0., -8.881784197001252*^-16}}}]], 0.8749949409780782}}}], 
         ArrowBox[{{0.7818314824680294, 
          0.6234898018587326}, {-0.9749279121818235, \
-0.22252093395631342`}}]}, 
        {Arrowheads[{{0.05, 0.8, {
             GraphicsBox[
              
              FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 
               0}}}, {{{-1., -0.31249915682968066`}, {-0.8749949409780775, \
-8.881784197001252*^-16}, {-1., 0.3124991568296789}, {
               0., -8.881784197001252*^-16}}}]], 0.8749949409780782}}}], 
         ArrowBox[{{-7.044813998280222*^-16, 1.}, {-0.7818314824680302, 
          0.6234898018587343}}]}, 
        {Arrowheads[{{0.05, 0.8, {
             GraphicsBox[
              
              FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 
               0}}}, {{{-1., -0.31249915682968066`}, {-0.8749949409780775, \
-8.881784197001252*^-16}, {-1., 0.3124991568296789}, {
               0., -8.881784197001252*^-16}}}]], 0.8749949409780782}}}], 
         ArrowBox[{{-7.044813998280222*^-16, 1.}, {
          0.43388373911755884`, -0.9009688679024196}}]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {
         DiskBox[{-0.7818314824680302, 0.6234898018587343}, 
          0.17355349564702308], InsetBox[
          StyleBox["1",
           StripOnInput->False,
           FontSize->28,
           FontSlant->Italic], {-0.7818314824680302, 0.6234898018587343},
          BaseStyle->"Graphics"]}, {
         DiskBox[{-0.9749279121818235, -0.22252093395631342}, 
          0.17355349564702308], InsetBox[
          StyleBox["2",
           StripOnInput->False,
           FontSize->28,
           FontSlant->Italic], {-0.9749279121818235, -0.22252093395631342},
          BaseStyle->"Graphics"]}, {
         DiskBox[{-0.43388373911755757, -0.9009688679024187}, 
          0.17355349564702308], InsetBox[
          StyleBox["3",
           StripOnInput->False,
           FontSize->28,
           FontSlant->Italic], {-0.43388373911755757, -0.9009688679024187},
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.43388373911755884, -0.9009688679024196}, 
          0.17355349564702308], InsetBox[
          StyleBox["4",
           StripOnInput->False,
           FontSize->28,
           FontSlant->Italic], {0.43388373911755884, -0.9009688679024196},
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.9749279121818237, -0.2225209339563155}, 
          0.17355349564702308], InsetBox[
          StyleBox["5",
           StripOnInput->False,
           FontSize->28,
           FontSlant->Italic], {0.9749279121818237, -0.2225209339563155},
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.7818314824680294, 0.6234898018587326}, 
          0.17355349564702308], InsetBox[
          StyleBox["6",
           StripOnInput->False,
           FontSize->28,
           FontSlant->Italic], {0.7818314824680294, 0.6234898018587326},
          BaseStyle->"Graphics"]}, {
         DiskBox[{-7.044813998280222*^-16, 1.}, 0.17355349564702308], InsetBox[
          StyleBox["7",
           StripOnInput->False,
           FontSize->28,
           FontSlant->Italic], {-7.044813998280222*^-16, 1.},
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Output",
 CellChangeTimes->{3.7791034674427423`*^9, 3.7791164095481567`*^9, 
  3.7791178341151857`*^9, 3.7791206192941213`*^9, 3.7814383579620514`*^9, 
  3.781520746798287*^9, 3.7815332720508847`*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"462947a4-48cf-4e07-bb88-15027fb86478"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "3.", " ", "\:041f\:043e\:0441\:0442\:0440\:043e\:0438\:0442\:044c", " ", 
    "\:0441\:043f\:0438\:0441\:043a\:043e\:0432\:044b\:0435", " ", 
    "\:0441\:0442\:0440\:0443\:043a\:0442\:0443\:0440\:044b", " ", 
    "\:0445\:0440\:0430\:043d\:0435\:043d\:0438\:044f", " ", 
    "\:043a\:043e\:0440\:043d\:0435\:0432\:043e\:0433\:043e", " ", 
    "\:0434\:0435\:0440\:0435\:0432\:0430", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "\:0441\:043f\:0438\:0441\:043e\:043a", " ", 
       "\:0443\:0437\:043b\:043e\:0432"}], ",", " ", 
      RowBox[{
      "\:0441\:043f\:0438\:0441\:043e\:043a", " ", 
       "\:043f\:0440\:0435\:0434\:043a\:043e\:0432"}], ",", " ", 
      RowBox[{
      "\:0441\:043f\:0438\:0441\:043e\:043a", " ", 
       "\:043d\:0430\:043f\:0440\:0430\:0432\:043b\:0435\:043d\:0438\:0439"}],
       ",", " ", 
      RowBox[{
      "\:0441\:043f\:0438\:0441\:043e\:043a", " ", 
       "\:0433\:043b\:0443\:0431\:0438\:043d", " ", 
       "\:0443\:0437\:043b\:043e\:0432"}], ",", " ", 
      RowBox[{
       RowBox[{
       "\:0441\:043f\:0438\:0441\:043e\:043a", " ", 
        "\:0441\:0432\:044f\:0437\:0438", " ", "\:0438\:043b\:0438", " ", 
        "\:0434\:0438\:043d\:0430\:0441\:0442\:0438\:0447\:0435\:0441\:043a\
\:043e\:0433\:043e", " ", "\:043e\:0431\:0445\:043e\:0434\:0430"}], ";", 
       RowBox[{
        RowBox[{
        "\:043a\:043e\:0440\:0435\:043d\:044c", " ", 
         "\:0434\:0435\:0440\:0435\:0432\:0430"}], "-", 
        "\:0443\:0437\:0435\:043b"}]}], ",", " ", 
      RowBox[{
      "\:043e\:0442", " ", "\:043a\:043e\:0442\:043e\:0440\:043e\:0433\:043e",
        " ", "\:0441\:0442\:0440\:043e\:0438\:043b\:0438", " ", 
       "\:043f\:043e\:043a\:0440\:044b\:0432\:0430\:044e\:0449\:0435\:0435", 
       " ", "\:0434\:0435\:0440\:0435\:0432\:043e"}], ",", " ", 
      RowBox[{
      "\:043b\:0438\:0431\:043e", " ", "\:043b\:044e\:0431\:043e\:0439", " ", 
       "\:043f\:0440\:043e\:0438\:0437\:0432\:043e\:043b\:044c\:043d\:044b\
\:0439", " ", 
       RowBox[{"\:0443\:0437\:0435\:043b", "."}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"pred", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "Is"}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "\:0441\:043f\:0438\:0441\:043e\:043a", " ", 
     "\:043f\:0440\:0435\:0434\:043a\:043e\:0432"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dir", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "Is"}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "\:0441\:043f\:0438\:0441\:043e\:043a", " ", 
     "\:043d\:0430\:043f\:0440\:0430\:0432\:043b\:0435\:043d\:0438\:0439"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"depth", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "Is"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "\:0441\:043f\:0438\:0441\:043e\:043a", " ", 
     "\:0433\:043b\:0443\:0431\:0438\:043d", " ", 
     "\:0443\:0437\:043b\:043e\:0432"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dinast", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "Is"}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "\:0434\:0438\:043d\:0430\:0441\:0442\:0438\:0447\:0435\:0441\:0438\:0439\
", " ", "\:043e\:0431\:0445\:043e\:0434"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"posl", "=", 
     RowBox[{"{", "}"}]}], ";"}], 
   "                                            ", 
   RowBox[{"(*", 
    RowBox[{
    "\:043f\:043e\:0441\:043b\:0435\:0434\:043e\:0432\:0430\:0442\:0435\:043b\
\:044c\:043d\:043e\:0441\:0442\:044c", " ", 
     "\:043e\:0431\:0445\:043e\:0434\:0430"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RootTree", "=", 
     RowBox[{"{", "}"}]}], ";"}], "                                   ", 
   RowBox[{"(*", 
    RowBox[{
    "\:043a\:043e\:0440\:043d\:0435\:0432\:043e\:0435", " ", 
     "\:0434\:0435\:0440\:0435\:0432\:043e"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ut", "=", 
     RowBox[{"{", "}"}]}], ";"}], 
   "                                               ", 
   RowBox[{"(*", 
    RowBox[{
    "\:043f\:043e\:043a\:0440\:044b\:0432\:0430\:044e\:0449\:0435\:0435", " ",
      "\:0434\:0435\:0440\:0435\:0432\:043e"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"root", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ug", "=", 
     RowBox[{"UndirectedGraph", "[", "g", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DepthFirstScan", "[", 
     RowBox[{"ug", ",", "root", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<FrontierEdge\>\"", "\[Rule]", 
         RowBox[{"Function", "[", 
          RowBox[{"edge", ",", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"pred", "[", 
               RowBox[{"[", 
                RowBox[{"edge", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "=", 
              RowBox[{"edge", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"depth", "[", 
               RowBox[{"[", 
                RowBox[{"edge", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"depth", "[", 
                RowBox[{"[", 
                 RowBox[{"edge", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], " ", "+", " ",
                "1"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "=", 
                RowBox[{
                 RowBox[{"edge", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "\[DirectedEdge]", 
                 RowBox[{"edge", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"RootTree", ",", "i"}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"UDirect", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"Ut", ",", "i"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"dir", "[", 
                    RowBox[{"[", 
                    RowBox[{"edge", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "=", 
                    "1"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"Ut", ",", 
                    RowBox[{
                    RowBox[{"edge", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[DirectedEdge]", 
                    RowBox[{"edge", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"dir", "[", 
                    RowBox[{"[", 
                    RowBox[{"edge", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}]}], "}"}]}], "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<PrevisitVertex\>\"", "\[Rule]", 
         RowBox[{"Function", "[", 
          RowBox[{"vertex", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"posl", "\[NotEqual]", 
                RowBox[{"{", "}"}]}], ",", 
               RowBox[{
                RowBox[{"dinast", "[", 
                 RowBox[{"[", 
                  RowBox[{"posl", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
                "vertex"}]}], "]"}], ",", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"posl", ",", "vertex"}], "]"}]}], "}"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dinast", "[", 
      RowBox[{"[", 
       RowBox[{"posl", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "]"}], "=", "root"}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"Range", "[", "Is", "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "pred", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "depth", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "dir", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "dinast", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "posl", "]"}], ";"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.7797067755087996`*^9, 3.7797067755207644`*^9}, {
   3.7799702358225727`*^9, 3.779970290797552*^9}, 3.779970416179081*^9, {
   3.779970453130262*^9, 3.779970492757286*^9}, {3.780250302830385*^9, 
   3.7802503114194117`*^9}, {3.780250844311304*^9, 3.780250848939929*^9}, {
   3.7802508936563396`*^9, 3.780250954231377*^9}, {3.780251018018789*^9, 
   3.7802510361213408`*^9}, {3.7802512897650137`*^9, 
   3.7802513290788755`*^9}, {3.780251681435704*^9, 3.7802518725426207`*^9}, {
   3.7802519379696436`*^9, 3.780252029709302*^9}, {3.780252069187723*^9, 
   3.7802520916137495`*^9}, {3.780252183053754*^9, 3.7802521931597257`*^9}, {
   3.780252223809755*^9, 3.780252260256287*^9}, {3.780252335922927*^9, 
   3.7802523783365*^9}, {3.7802524465650663`*^9, 3.7802525937723527`*^9}, 
   3.7803026633820376`*^9, {3.780302821801077*^9, 3.7803028643932056`*^9}, {
   3.7803030434632807`*^9, 3.780303085071006*^9}, {3.780303210884081*^9, 
   3.7803032230106163`*^9}, {3.7803032874562674`*^9, 
   3.7803032982194834`*^9}, {3.7803040090305204`*^9, 
   3.7803041659211445`*^9}, {3.7803042446685452`*^9, 3.780304255153504*^9}, {
   3.7803047027251177`*^9, 3.780304775958938*^9}, {3.780304830274922*^9, 
   3.78030485891696*^9}, {3.780304891700286*^9, 3.7803048942365026`*^9}, {
   3.7803050491074605`*^9, 3.780305071599312*^9}, {3.7803059882239885`*^9, 
   3.7803060245169606`*^9}, {3.7803060649880886`*^9, 
   3.7803060808955083`*^9}, {3.780306164482969*^9, 3.7803061790779715`*^9}, {
   3.7803063731728673`*^9, 3.7803063734301786`*^9}, {3.7803065899790554`*^9, 
   3.780306592111352*^9}, {3.780307717843113*^9, 3.7803077321398754`*^9}, {
   3.780308056863386*^9, 3.7803080634687257`*^9}, {3.780308232602403*^9, 
   3.780308304889118*^9}, {3.7803083433811445`*^9, 3.780308354188242*^9}, 
   3.780308544779543*^9, {3.7803087173625097`*^9, 3.780308807831561*^9}, {
   3.78030885673777*^9, 3.780309133591377*^9}, {3.780309259680169*^9, 
   3.7803092635907154`*^9}, {3.780309365704624*^9, 3.780309393108341*^9}, {
   3.7803096504102287`*^9, 3.7803096533184505`*^9}, {3.7803101238620615`*^9, 
   3.780310143827667*^9}, {3.780310192935337*^9, 3.7803102150551805`*^9}, {
   3.780310296133438*^9, 3.7803102995402937`*^9}, {3.7803108704674463`*^9, 
   3.7803108773659973`*^9}, 3.780310914923076*^9, {3.7803109667006063`*^9, 
   3.780310984482051*^9}, {3.7803116847883043`*^9, 3.7803116898603015`*^9}, 
   3.780312241641632*^9, {3.78031236067249*^9, 3.7803123892160797`*^9}, 
   3.7803125433614225`*^9, {3.7803129790612907`*^9, 3.7803129945997353`*^9}, {
   3.780313074834163*^9, 3.780313091697066*^9}, {3.7803132536091175`*^9, 
   3.7803133057886124`*^9}, {3.7803133404079585`*^9, 3.780313343838633*^9}, {
   3.780313380187255*^9, 3.7803133842045393`*^9}, {3.780313440870626*^9, 
   3.780313562332835*^9}, {3.780313597149727*^9, 3.7803136147745605`*^9}, {
   3.7803278514071455`*^9, 3.780327894893848*^9}, {3.780328348156744*^9, 
   3.7803284540315995`*^9}, {3.7803308004355235`*^9, 
   3.7803308371074533`*^9}, {3.780330898129832*^9, 3.780330901244535*^9}, {
   3.7803310866167583`*^9, 3.7803310867135005`*^9}, {3.780331125215913*^9, 
   3.7803311983672833`*^9}, {3.7803312531158648`*^9, 
   3.7803312599765167`*^9}, {3.780331560048065*^9, 3.780331580257023*^9}, {
   3.7803325643712735`*^9, 3.7803325711072903`*^9}, {3.7803327106016474`*^9, 
   3.7803327212909727`*^9}, {3.780332773877342*^9, 3.78033277763828*^9}, {
   3.781439114091798*^9, 3.781439114670166*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"6f255af4-03aa-4e7c-a313-92304b121d7b"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["            \
\:041b\:0430\:0431\:043e\:0440\:0430\:0442\:043e\:0440\:043d\:0430\:044f 5.",
 FontColor->RGBColor[1, 0, 0]]], "Chapter",
 CellChangeTimes->{{3.7791169818070498`*^9, 3.7791170025244665`*^9}, {
  3.7791170389099503`*^9, 3.7791170407474995`*^9}, {3.78143883534758*^9, 
  3.7814388388468895`*^9}},ExpressionUUID->"47e1b81e-fc00-4aaf-a68a-\
a11142d3bcb8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fileName", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Lab_5.pdf\>\""}], 
     "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"img", "=", 
   RowBox[{"Image", "[", 
    RowBox[{"Graph", "[", 
     RowBox[{"g", ",", 
      RowBox[{"GraphHighlight", "\[Rule]", 
       RowBox[{"EdgeList", "[", "Ut", "]"}]}], ",", 
      RowBox[{"GraphLayout", "\[Rule]", "\"\<CircularEmbedding\>\""}], ",", 
      RowBox[{"EdgeStyle", "\[Rule]", "Thick"}], ",", " ", 
      RowBox[{"VertexLabels", "\[Rule]", 
       RowBox[{"Placed", "[", 
        RowBox[{"\"\<Name\>\"", ",", "Center"}], "]"}]}], ",", " ", 
      RowBox[{"VertexSize", "\[Rule]", "0.4"}], ",", 
      RowBox[{"VertexLabelStyle", "\[Rule]", " ", 
       RowBox[{"Directive", "[", 
        RowBox[{"Italic", ",", " ", "28"}], "]"}]}]}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"nb2", "=", 
  RowBox[{"CreateDocument", "[", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"NotebookWrite", "[", 
   RowBox[{"nb2", ",", 
    RowBox[{"Cell", "[", 
     RowBox[{"\"\<\:0413\:0440\:0430\:0444:\>\"", ",", "\"\<Text\>\""}], 
     "]"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"NotebookWrite", "[", 
   RowBox[{"nb2", ",", 
    RowBox[{"ToBoxes", "[", "img", "]"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SelectionMove", "[", 
   RowBox[{"nb2", ",", "Next", ",", "Cell"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7815401655316153`*^9, 3.7815402041535997`*^9}, {
   3.781540295109847*^9, 3.78154029904233*^9}, {3.781540355657346*^9, 
   3.7815403603059125`*^9}, 3.781540424328681*^9, {3.781540471073145*^9, 
   3.781540484623835*^9}, {3.78154054734544*^9, 3.78154059179257*^9}, {
   3.781540919826518*^9, 3.7815409225443697`*^9}, 3.781542434953497*^9, {
   3.7815425226244354`*^9, 3.781542522751094*^9}},
 CellLabel->
  "In[443]:=",ExpressionUUID->"9d01b641-8e10-459c-ac35-b9f56d47a4a0"],

Cell[BoxData[
 TemplateBox[{FrontEndObject[
    LinkObject["a8v2f_shm", 3, 1]],33,
   "FrontEndObject[LinkObject[\"a8v2f_shm\", 3, 1]]","33","\"Untitled-8\""},
  "NotebookObjectUnsaved"]], "Output",
 CellChangeTimes->{3.7815411711991262`*^9, 3.7815412284102583`*^9, 
  3.781541784873732*^9, 3.781541879687335*^9, 3.7815422996169214`*^9, 
  3.7815424844022064`*^9, 3.7815425251686273`*^9},
 CellLabel->
  "Out[445]=",ExpressionUUID->"ebfdc331-fda2-4c21-addc-f34079bc9e9c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "1.", " ", "\:041d\:0430\:043f\:0438\:0441\:0430\:0442\:044c", " ", 
     "\:0444\:0443\:043d\:043a\:0446\:0438\:044e", " ", 
     "\:043f\:043e\:0441\:0442\:0440\:043e\:0435\:043d\:0438\:044f", " ", 
     "\:0447\:0430\:0441\:0442\:043d\:043e\:0433\:043e", " ", 
     "\:0440\:0435\:0448\:0435\:043d\:0438\:044f", " ", 
     "\:0441\:0438\:0441\:0442\:0435\:043c\:044b", " ", 
     "\:0443\:0440\:0430\:0432\:043d\:0435\:043d\:0438\:0439", " ", 
     "\:0431\:0430\:043b\:0430\:043d\:0441\:0430", " ", 
     RowBox[{"(", 
      RowBox[{
      "\:0432", " ", 
       "\:0444\:0443\:043d\:043a\:0446\:0438\:043e\:043d\:0430\:043b\:044c\
\:043d\:043e\:043c", " ", "\:0441\:0442\:0438\:043b\:0435"}], ")"}]}], ";"}], 
   "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"edges", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Subscript", "[", 
        RowBox[{"x", ",", "#"}], "]"}], "&"}], "/@", "UDirect"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h", "[", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xp", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "Is"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "Us"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"complement", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{"UDirect", ",", "Ut"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"reverse", "=", 
        RowBox[{"Reverse", "[", "posl", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xp", "=", 
        RowBox[{"Fold", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "=", "#2"}], ",", 
               RowBox[{"j", "=", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"dir", "[", 
                   RowBox[{"[", "#2", "]"}], "]"}]}], "*", 
                 RowBox[{"ToExpression", "[", 
                  RowBox[{
                   RowBox[{"b", "[", 
                    RowBox[{"[", "#2", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}]}], "}"}], ",", 
             " ", 
             RowBox[{"ReplacePart", "[", 
              RowBox[{"#1", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"i", "\[Rule]", 
                  RowBox[{
                   RowBox[{"#1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "+", "j"}]}], ",", 
                 RowBox[{
                  RowBox[{"pred", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
                  RowBox[{
                   RowBox[{"#1", "[", 
                    RowBox[{"[", 
                    RowBox[{"pred", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "+", 
                   RowBox[{
                    RowBox[{"dir", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "*", 
                    RowBox[{"dir", "[", 
                    RowBox[{"[", 
                    RowBox[{"pred", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "+", "j"}], ")"}]}]}]}]}],
                 "}"}]}], "]"}]}], "]"}], "&"}], ",", "xp", ",", 
          RowBox[{"Take", "[", 
           RowBox[{"reverse", ",", 
            RowBox[{"Is", "-", "1"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"Return", "[", "0", "]"}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"complement", ",", 
           RowBox[{"i", "\[DirectedEdge]", "j"}]}], "]"}]}]}], ";", "\n", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"Return", "[", 
          RowBox[{"xp", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "]"}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"RootTree", ",", 
           RowBox[{"i", "\[DirectedEdge]", "j"}]}], "]"}]}]}], ";", "\n", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"Return", "[", 
          RowBox[{"xp", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"RootTree", ",", 
           RowBox[{"j", "\[DirectedEdge]", "i"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"edges", "[", 
            RowBox[{"[", "n", "]"}], "]"}], "==", 
           RowBox[{"f", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"edges", "[", 
                RowBox[{"[", "n", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"edges", "[", 
                RowBox[{"[", "n", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", "Us"}], "}"}]}], "]"}]}]}]}], "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7814389749674387`*^9, 3.7814389963311243`*^9}, {
   3.7814390551259003`*^9, 3.7814390712339783`*^9}, 3.7814391219920735`*^9, {
   3.7814394857441416`*^9, 3.7814395313909645`*^9}, {3.7814396837917366`*^9, 
   3.781439705219406*^9}, {3.7814399979508085`*^9, 3.7814400112376394`*^9}, {
   3.781520935434218*^9, 3.781521014774743*^9}, {3.781521077994221*^9, 
   3.781521129498299*^9}, 3.781521831341705*^9, {3.7815218895045776`*^9, 
   3.7815219609726343`*^9}, {3.781522002258629*^9, 3.7815220421578465`*^9}, {
   3.7815221348134747`*^9, 3.7815221385696774`*^9}, {3.7815222094965982`*^9, 
   3.781522326071553*^9}, {3.781522410328454*^9, 3.7815224258686132`*^9}, {
   3.7815224788474894`*^9, 3.7815225106256733`*^9}, {3.781522609025224*^9, 
   3.7815226391667995`*^9}, {3.781522671702871*^9, 3.7815227892170343`*^9}, {
   3.781522841659546*^9, 3.781522849178896*^9}, {3.7815228880077133`*^9, 
   3.781522898587908*^9}, {3.7815229420230374`*^9, 3.781523042032107*^9}, {
   3.7815230951883616`*^9, 3.7815231171482353`*^9}, {3.78152366955643*^9, 
   3.7815236927949924`*^9}, {3.781533326423462*^9, 3.781533339977212*^9}, {
   3.781533386554449*^9, 3.781533451924244*^9}, {3.7815346909669094`*^9, 
   3.781534694744775*^9}, {3.7815348578934565`*^9, 3.7815349052776957`*^9}, 
   3.7815349361989946`*^9, 3.7815349823775234`*^9, 3.7815350212291265`*^9, {
   3.7815351163675365`*^9, 3.781535121877802*^9}, {3.7815351607388725`*^9, 
   3.78153516582227*^9}, 3.7815352655365767`*^9, {3.781536135716958*^9, 
   3.7815362053866234`*^9}, {3.781536330893948*^9, 3.7815363390880327`*^9}, 
   3.7815363695904555`*^9, {3.781536663609193*^9, 3.7815366911899867`*^9}, {
   3.7815367379439774`*^9, 3.781536799976327*^9}, 3.7815368486541376`*^9, {
   3.7815369243566637`*^9, 3.781536930574038*^9}, {3.7815386111099744`*^9, 
   3.781538623703259*^9}, {3.7815387447999334`*^9, 3.781538882768895*^9}, {
   3.781539203688152*^9, 3.781539239859413*^9}, {3.7815393172165184`*^9, 
   3.781539355242814*^9}, {3.7815394970143657`*^9, 3.7815395842299337`*^9}, {
   3.781539633066797*^9, 3.781539660012429*^9}},
 CellLabel->
  "In[449]:=",ExpressionUUID->"2b44e469-4006-43e2-9dc3-33bc482d1d88"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "2.", " ", "\:041d\:0430\:0439\:0442\:0438", " ", "\:0438", " ", 
     "\:0432\:044b\:0432\:0435\:0441\:0442\:0438", " ", 
     "\:0447\:0430\:0441\:0442\:043d\:043e\:0435", " ", 
     "\:0440\:0435\:0448\:0435\:043d\:0438\:0435", " ", "\:0434\:043b\:044f", 
     " ", "\:0441\:0432\:043e\:0435\:0439", " ", 
     "\:0441\:0438\:0441\:0442\:0435\:043c\:044b", " ", 
     "\:0443\:0440\:0430\:0432\:043d\:0435\:043d\:0438\:0439"}], ",", 
    RowBox[{
    "\:043f\:0440\:043e\:0432\:0435\:0440\:0438\:0442\:044c", " ", 
     "\:043f\:0440\:0430\:0432\:0438\:043b\:044c\:043d\:043e\:0441\:0442\:044c\
", " ", "\:043d\:0430\:0439\:0434\:0435\:043d\:043d\:043e\:0433\:043e", " ", 
     "\:0440\:0435\:0448\:0435\:043d\:0438\:044f", " ", 
     "\:043f\:0443\:0442\:0451\:043c", " ", 
     "\:043f\:043e\:0434\:0441\:0442\:0430\:043d\:043e\:0432\:043a\:0438", 
     " ", "\:0440\:0435\:0448\:0435\:043d\:0438\:044f", " ", "\:0432", " ", 
     "\:0441\:0438\:0441\:0442\:0435\:043c\:0443", " ", 
     RowBox[{
      RowBox[{"(", "Solve", ")"}], "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"r", "=", 
    RowBox[{"h", "[", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"s", "=", 
    RowBox[{"Solve", "[", "r", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"s", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"r", "/.", 
      RowBox[{"s", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NotebookWrite", "[", 
     RowBox[{"nb2", ",", 
      RowBox[{"Cell", "[", 
       RowBox[{
       "\"\<\:0427\:0430\:0441\:0442\:043d\:043e\:0435 \:0440\:0435\:0448\
\:0435\:043d\:0438\:0435:\>\"", ",", "\"\<Text\>\""}], "]"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NotebookWrite", "[", 
     RowBox[{"nb2", ",", 
      RowBox[{"ToBoxes", "[", "r", "]"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SelectionMove", "[", 
     RowBox[{"nb2", ",", "Next", ",", "Cell"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NotebookWrite", "[", 
     RowBox[{"nb2", ",", 
      RowBox[{"Cell", "[", 
       RowBox[{
       "\"\<\:041f\:0440\:043e\:0432\:0435\:0440\:043a\:0430 \:0440\:0435\
\:0448\:0435\:043d\:0438\:044f:\>\"", ",", "\"\<Text\>\""}], "]"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NotebookWrite", "[", 
     RowBox[{"nb2", ",", 
      RowBox[{"ToBoxes", "[", "s", "]"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"fileName", ",", "nb2"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.781540777970344*^9, 3.781540778418144*^9}, {
   3.781540896457384*^9, 3.781540961017026*^9}, {3.781541001745097*^9, 
   3.781541002160018*^9}, {3.7815410960075865`*^9, 3.781541098180808*^9}, {
   3.7815412236609607`*^9, 3.781541224074854*^9}, 3.78154146656505*^9, {
   3.7815416324590616`*^9, 3.7815416593830853`*^9}, {3.7815417577782016`*^9, 
   3.781541775113834*^9}, 3.7815420010744815`*^9, {3.7815420501079288`*^9, 
   3.7815420951703444`*^9}, {3.7815422315479784`*^9, 3.781542290080426*^9}, {
   3.7815423623392553`*^9, 3.7815423972370844`*^9}, 3.7815424444999304`*^9, {
   3.7815425127608137`*^9, 3.781542533752669*^9}},
 CellLabel->
  "In[451]:=",ExpressionUUID->"602b5595-4c47-44b1-9e30-884e3c21f47d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["x", 
     RowBox[{"1", "\[DirectedEdge]", "2"}]], "\[Equal]", "0"}], ",", 
   RowBox[{
    SubscriptBox["x", 
     RowBox[{"3", "\[DirectedEdge]", "1"}]], "\[Equal]", 
    RowBox[{"-", "2"}]}], ",", 
   RowBox[{
    SubscriptBox["x", 
     RowBox[{"1", "\[DirectedEdge]", "4"}]], "\[Equal]", "0"}], ",", 
   RowBox[{
    SubscriptBox["x", 
     RowBox[{"5", "\[DirectedEdge]", "2"}]], "\[Equal]", "3"}], ",", 
   RowBox[{
    SubscriptBox["x", 
     RowBox[{"1", "\[DirectedEdge]", "6"}]], "\[Equal]", "0"}], ",", 
   RowBox[{
    SubscriptBox["x", 
     RowBox[{"3", "\[DirectedEdge]", "6"}]], "\[Equal]", "0"}], ",", 
   RowBox[{
    SubscriptBox["x", 
     RowBox[{"3", "\[DirectedEdge]", "7"}]], "\[Equal]", "0"}], ",", 
   RowBox[{
    SubscriptBox["x", 
     RowBox[{"4", "\[DirectedEdge]", "3"}]], "\[Equal]", "2"}], ",", 
   RowBox[{
    SubscriptBox["x", 
     RowBox[{"5", "\[DirectedEdge]", "3"}]], "\[Equal]", "0"}], ",", 
   RowBox[{
    SubscriptBox["x", 
     RowBox[{"5", "\[DirectedEdge]", "6"}]], "\[Equal]", "0"}], ",", 
   RowBox[{
    SubscriptBox["x", 
     RowBox[{"6", "\[DirectedEdge]", "2"}]], "\[Equal]", "3"}], ",", 
   RowBox[{
    SubscriptBox["x", 
     RowBox[{"7", "\[DirectedEdge]", "1"}]], "\[Equal]", "0"}], ",", 
   RowBox[{
    SubscriptBox["x", 
     RowBox[{"7", "\[DirectedEdge]", "4"}]], "\[Equal]", "3"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.7815417773847857`*^9, 3.7815417900698333`*^9}, 
   3.7815418838432207`*^9, 3.7815420035638256`*^9, {3.7815420809215155`*^9, 
   3.7815420960240602`*^9}, 3.781542239218461*^9, 3.781542281365737*^9, 
   3.781542399537934*^9, 3.781542491400491*^9, 3.7815425362928743`*^9},
 CellLabel->
  "Out[451]=",ExpressionUUID->"03bcef74-879e-47b2-9649-b7259a8b1418"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SubscriptBox["x", 
      RowBox[{"1", "\[DirectedEdge]", "2"}]], "\[Rule]", "0"}], ",", 
    RowBox[{
     SubscriptBox["x", 
      RowBox[{"1", "\[DirectedEdge]", "4"}]], "\[Rule]", "0"}], ",", 
    RowBox[{
     SubscriptBox["x", 
      RowBox[{"1", "\[DirectedEdge]", "6"}]], "\[Rule]", "0"}], ",", 
    RowBox[{
     SubscriptBox["x", 
      RowBox[{"3", "\[DirectedEdge]", "1"}]], "\[Rule]", 
     RowBox[{"-", "2"}]}], ",", 
    RowBox[{
     SubscriptBox["x", 
      RowBox[{"3", "\[DirectedEdge]", "6"}]], "\[Rule]", "0"}], ",", 
    RowBox[{
     SubscriptBox["x", 
      RowBox[{"3", "\[DirectedEdge]", "7"}]], "\[Rule]", "0"}], ",", 
    RowBox[{
     SubscriptBox["x", 
      RowBox[{"4", "\[DirectedEdge]", "3"}]], "\[Rule]", "2"}], ",", 
    RowBox[{
     SubscriptBox["x", 
      RowBox[{"5", "\[DirectedEdge]", "2"}]], "\[Rule]", "3"}], ",", 
    RowBox[{
     SubscriptBox["x", 
      RowBox[{"5", "\[DirectedEdge]", "3"}]], "\[Rule]", "0"}], ",", 
    RowBox[{
     SubscriptBox["x", 
      RowBox[{"5", "\[DirectedEdge]", "6"}]], "\[Rule]", "0"}], ",", 
    RowBox[{
     SubscriptBox["x", 
      RowBox[{"6", "\[DirectedEdge]", "2"}]], "\[Rule]", "3"}], ",", 
    RowBox[{
     SubscriptBox["x", 
      RowBox[{"7", "\[DirectedEdge]", "1"}]], "\[Rule]", "0"}], ",", 
    RowBox[{
     SubscriptBox["x", 
      RowBox[{"7", "\[DirectedEdge]", "4"}]], "\[Rule]", "3"}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.7815417773847857`*^9, 3.7815417900698333`*^9}, 
   3.7815418838432207`*^9, 3.7815420035638256`*^9, {3.7815420809215155`*^9, 
   3.7815420960240602`*^9}, 3.781542239218461*^9, 3.781542281365737*^9, 
   3.781542399537934*^9, 3.781542491400491*^9, 3.781542536306838*^9},
 CellLabel->
  "Out[452]=",ExpressionUUID->"d697766b-24e2-475a-b084-0f7aaa14a552"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", 
   ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", 
   "True", ",", "True"}], "}"}]], "Output",
 CellChangeTimes->{{3.7815417773847857`*^9, 3.7815417900698333`*^9}, 
   3.7815418838432207`*^9, 3.7815420035638256`*^9, {3.7815420809215155`*^9, 
   3.7815420960240602`*^9}, 3.781542239218461*^9, 3.781542281365737*^9, 
   3.781542399537934*^9, 3.781542491400491*^9, 3.78154253631382*^9},
 CellLabel->
  "Out[453]=",ExpressionUUID->"ad7e5aa4-3676-485c-91f8-bfd1b4770451"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1520, 781},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1426, 28, 28, "Input",ExpressionUUID->"1b7ce8ea-dbff-4939-9217-7bcd9cdeb321"],
Cell[CellGroupData[{
Cell[2009, 52, 4790, 104, 362, "Input",ExpressionUUID->"e69d8df6-be5a-4f90-a502-029034a4cbd3"],
Cell[6802, 158, 2898, 47, 32, "Output",ExpressionUUID->"00cb8ff5-8dac-47a9-9b39-248f1589dec0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9737, 210, 1526, 31, 120, "Input",ExpressionUUID->"f1742808-91c5-4adb-b771-865cc7d1513c"],
Cell[11266, 243, 9304, 194, 369, "Output",ExpressionUUID->"462947a4-48cf-4e07-bb88-15027fb86478"]
}, Open  ]],
Cell[20585, 440, 12502, 267, 629, "Input",ExpressionUUID->"6f255af4-03aa-4e7c-a313-92304b121d7b"],
Cell[CellGroupData[{
Cell[33112, 711, 389, 6, 67, "Chapter",ExpressionUUID->"47e1b81e-fc00-4aaf-a68a-a11142d3bcb8"],
Cell[CellGroupData[{
Cell[33526, 721, 1956, 47, 267, "Input",ExpressionUUID->"9d01b641-8e10-459c-ac35-b9f56d47a4a0"],
Cell[35485, 770, 471, 9, 51, "Output",ExpressionUUID->"ebfdc331-fda2-4c21-addc-f34079bc9e9c"]
}, Open  ]],
Cell[35971, 782, 7974, 177, 492, "Input",ExpressionUUID->"2b44e469-4006-43e2-9dc3-33bc482d1d88"],
Cell[CellGroupData[{
Cell[43970, 963, 3401, 76, 342, "Input",ExpressionUUID->"602b5595-4c47-44b1-9e30-884e3c21f47d"],
Cell[47374, 1041, 1816, 49, 32, "Output",ExpressionUUID->"03bcef74-879e-47b2-9649-b7259a8b1418"],
Cell[49193, 1092, 1865, 50, 32, "Output",ExpressionUUID->"d697766b-24e2-475a-b084-0f7aaa14a552"],
Cell[51061, 1144, 605, 11, 65, "Output",ExpressionUUID->"ad7e5aa4-3676-485c-91f8-bfd1b4770451"]
}, Open  ]]
}, Open  ]]
}
]
*)

